Fix the dataset thing because it doesn't work at all in Safari

Sanatize user inputs everywhere for safety